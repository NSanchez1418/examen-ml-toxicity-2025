{
  "hash": "f33dc33b1213bc8638ab78bfa6a830e0",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Hierachical Agglomerative Clustering (HAC)\"\ncode-fold: false\n---\n\n# Importar las librer√≠as\n\n::: {#82d14821 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport altair as alt\nfrom sklearn.datasets import load_iris\nfrom sklearn.cluster import AgglomerativeClustering\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.pipeline import Pipeline\n\nfrom scipy.cluster.hierarchy import dendrogram,linkage\n\nimport matplotlib.pyplot as plt\n```\n:::\n\n\n# Cargar el dataset\n\n::: {#60b4ea14 .cell execution_count=2}\n``` {.python .cell-code}\niris = load_iris()\nX = pd.DataFrame(iris.data,columns=iris.feature_names)[['sepal length (cm)','sepal width (cm)']].iloc[:50]\nX\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sepal length (cm)</th>\n      <th>sepal width (cm)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>5.1</td>\n      <td>3.5</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>4.9</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>4.7</td>\n      <td>3.2</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4.6</td>\n      <td>3.1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5.0</td>\n      <td>3.6</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>5.4</td>\n      <td>3.9</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>4.6</td>\n      <td>3.4</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>5.0</td>\n      <td>3.4</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>4.4</td>\n      <td>2.9</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>4.9</td>\n      <td>3.1</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>5.4</td>\n      <td>3.7</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>4.8</td>\n      <td>3.4</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>4.8</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>4.3</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>5.8</td>\n      <td>4.0</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>5.7</td>\n      <td>4.4</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>5.4</td>\n      <td>3.9</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>5.1</td>\n      <td>3.5</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>5.7</td>\n      <td>3.8</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>5.1</td>\n      <td>3.8</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>5.4</td>\n      <td>3.4</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>5.1</td>\n      <td>3.7</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>4.6</td>\n      <td>3.6</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>5.1</td>\n      <td>3.3</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>4.8</td>\n      <td>3.4</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>5.0</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>5.0</td>\n      <td>3.4</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>5.2</td>\n      <td>3.5</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>5.2</td>\n      <td>3.4</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>4.7</td>\n      <td>3.2</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>4.8</td>\n      <td>3.1</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>5.4</td>\n      <td>3.4</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>5.2</td>\n      <td>4.1</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>5.5</td>\n      <td>4.2</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>4.9</td>\n      <td>3.1</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>5.0</td>\n      <td>3.2</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>5.5</td>\n      <td>3.5</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>4.9</td>\n      <td>3.6</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>4.4</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>5.1</td>\n      <td>3.4</td>\n    </tr>\n    <tr>\n      <th>40</th>\n      <td>5.0</td>\n      <td>3.5</td>\n    </tr>\n    <tr>\n      <th>41</th>\n      <td>4.5</td>\n      <td>2.3</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>4.4</td>\n      <td>3.2</td>\n    </tr>\n    <tr>\n      <th>43</th>\n      <td>5.0</td>\n      <td>3.5</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>5.1</td>\n      <td>3.8</td>\n    </tr>\n    <tr>\n      <th>45</th>\n      <td>4.8</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>46</th>\n      <td>5.1</td>\n      <td>3.8</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>4.6</td>\n      <td>3.2</td>\n    </tr>\n    <tr>\n      <th>48</th>\n      <td>5.3</td>\n      <td>3.7</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>5.0</td>\n      <td>3.3</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n# Pipeline\n\n::: {#9927bffa .cell execution_count=3}\n``` {.python .cell-code}\npipeline = Pipeline(\n    [\n        ('scaler',StandardScaler()),\n        ('agglo',AgglomerativeClustering(n_clusters=3))\n    ]\n)\n```\n:::\n\n\n# Fit\n\n::: {#9ea5aa7c .cell execution_count=4}\n``` {.python .cell-code}\nlabels = pipeline.fit_predict(X)\nlabels\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\narray([2, 0, 0, 0, 2, 1, 0, 2, 0, 0, 1, 0, 0, 0, 1, 1, 1, 2, 1, 1, 2, 1,\n       0, 2, 0, 0, 2, 2, 2, 0, 0, 2, 1, 1, 0, 2, 2, 2, 0, 2, 2, 0, 0, 2,\n       1, 0, 1, 0, 1, 2])\n```\n:::\n:::\n\n\n# Visualizar los clusters\n\n## Creacion del dataframe para la viz\n\n::: {#e87aa390 .cell execution_count=5}\n``` {.python .cell-code}\nX_scaled = pipeline.named_steps['scaler'].transform(X)\ndf_viz = pd.DataFrame(X_scaled,columns=['Feature1','Feature2'])\ndf_viz['clusters'] = labels.astype(str)\ndf_viz['index'] = X.index.astype(str)\ndf_viz\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Feature1</th>\n      <th>Feature2</th>\n      <th>clusters</th>\n      <th>index</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.269382</td>\n      <td>0.191870</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>-0.303771</td>\n      <td>-1.140559</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>-0.876924</td>\n      <td>-0.607588</td>\n      <td>0</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>-1.163501</td>\n      <td>-0.874073</td>\n      <td>0</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>-0.017195</td>\n      <td>0.458355</td>\n      <td>2</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>1.129111</td>\n      <td>1.257813</td>\n      <td>1</td>\n      <td>5</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>-1.163501</td>\n      <td>-0.074616</td>\n      <td>0</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>-0.017195</td>\n      <td>-0.074616</td>\n      <td>2</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>-1.736653</td>\n      <td>-1.407045</td>\n      <td>0</td>\n      <td>8</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>-0.303771</td>\n      <td>-0.874073</td>\n      <td>0</td>\n      <td>9</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>1.129111</td>\n      <td>0.724841</td>\n      <td>1</td>\n      <td>10</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>-0.590348</td>\n      <td>-0.074616</td>\n      <td>0</td>\n      <td>11</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>-0.590348</td>\n      <td>-1.140559</td>\n      <td>0</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>-2.023230</td>\n      <td>-1.140559</td>\n      <td>0</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>2.275417</td>\n      <td>1.524299</td>\n      <td>1</td>\n      <td>14</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>1.988841</td>\n      <td>2.590242</td>\n      <td>1</td>\n      <td>15</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>1.129111</td>\n      <td>1.257813</td>\n      <td>1</td>\n      <td>16</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>0.269382</td>\n      <td>0.191870</td>\n      <td>2</td>\n      <td>17</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>1.988841</td>\n      <td>0.991327</td>\n      <td>1</td>\n      <td>18</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>0.269382</td>\n      <td>0.991327</td>\n      <td>1</td>\n      <td>19</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>1.129111</td>\n      <td>-0.074616</td>\n      <td>2</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>0.269382</td>\n      <td>0.724841</td>\n      <td>1</td>\n      <td>21</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>-1.163501</td>\n      <td>0.458355</td>\n      <td>0</td>\n      <td>22</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>0.269382</td>\n      <td>-0.341102</td>\n      <td>2</td>\n      <td>23</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>-0.590348</td>\n      <td>-0.074616</td>\n      <td>0</td>\n      <td>24</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>-0.017195</td>\n      <td>-1.140559</td>\n      <td>0</td>\n      <td>25</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>-0.017195</td>\n      <td>-0.074616</td>\n      <td>2</td>\n      <td>26</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>0.555958</td>\n      <td>0.191870</td>\n      <td>2</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>0.555958</td>\n      <td>-0.074616</td>\n      <td>2</td>\n      <td>28</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>-0.876924</td>\n      <td>-0.607588</td>\n      <td>0</td>\n      <td>29</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>-0.590348</td>\n      <td>-0.874073</td>\n      <td>0</td>\n      <td>30</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>1.129111</td>\n      <td>-0.074616</td>\n      <td>2</td>\n      <td>31</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>0.555958</td>\n      <td>1.790784</td>\n      <td>1</td>\n      <td>32</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>1.415688</td>\n      <td>2.057270</td>\n      <td>1</td>\n      <td>33</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>-0.303771</td>\n      <td>-0.874073</td>\n      <td>0</td>\n      <td>34</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>-0.017195</td>\n      <td>-0.607588</td>\n      <td>2</td>\n      <td>35</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>1.415688</td>\n      <td>0.191870</td>\n      <td>2</td>\n      <td>36</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>-0.303771</td>\n      <td>0.458355</td>\n      <td>2</td>\n      <td>37</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>-1.736653</td>\n      <td>-1.140559</td>\n      <td>0</td>\n      <td>38</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>0.269382</td>\n      <td>-0.074616</td>\n      <td>2</td>\n      <td>39</td>\n    </tr>\n    <tr>\n      <th>40</th>\n      <td>-0.017195</td>\n      <td>0.191870</td>\n      <td>2</td>\n      <td>40</td>\n    </tr>\n    <tr>\n      <th>41</th>\n      <td>-1.450077</td>\n      <td>-3.005959</td>\n      <td>0</td>\n      <td>41</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>-1.736653</td>\n      <td>-0.607588</td>\n      <td>0</td>\n      <td>42</td>\n    </tr>\n    <tr>\n      <th>43</th>\n      <td>-0.017195</td>\n      <td>0.191870</td>\n      <td>2</td>\n      <td>43</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>0.269382</td>\n      <td>0.991327</td>\n      <td>1</td>\n      <td>44</td>\n    </tr>\n    <tr>\n      <th>45</th>\n      <td>-0.590348</td>\n      <td>-1.140559</td>\n      <td>0</td>\n      <td>45</td>\n    </tr>\n    <tr>\n      <th>46</th>\n      <td>0.269382</td>\n      <td>0.991327</td>\n      <td>1</td>\n      <td>46</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>-1.163501</td>\n      <td>-0.607588</td>\n      <td>0</td>\n      <td>47</td>\n    </tr>\n    <tr>\n      <th>48</th>\n      <td>0.842535</td>\n      <td>0.724841</td>\n      <td>1</td>\n      <td>48</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>-0.017195</td>\n      <td>-0.341102</td>\n      <td>2</td>\n      <td>49</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Visualizaci√≥n\n\n::: {#43171c56 .cell execution_count=6}\n``` {.python .cell-code}\nscatter = alt.Chart(df_viz).mark_circle(size=65).encode(\n    alt.X('Feature1'),\n    alt.Y('Feature2'),\n    alt.Color('clusters'),\n    tooltip=['Feature1','Feature2','index']\n).interactive()\n\ntexto_scatter = alt.Chart(df_viz).mark_text(\n    align='left',\n    dx=5,\n    baseline='middle'\n).encode(\n    alt.X('Feature1'),\n    alt.Y('Feature2'),\n    text='index'\n)\n\n\n(scatter + texto_scatter).properties(\n    width=500,\n    height=500\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n\n<style>\n  #altair-viz-3f14e628ce0944489be4782ad1ccad90.vega-embed {\n    width: 100%;\n    display: flex;\n  }\n\n  #altair-viz-3f14e628ce0944489be4782ad1ccad90.vega-embed details,\n  #altair-viz-3f14e628ce0944489be4782ad1ccad90.vega-embed details summary {\n    position: relative;\n  }\n</style>\n<div id=\"altair-viz-3f14e628ce0944489be4782ad1ccad90\"></div>\n<script type=\"text/javascript\">\n  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n  (function(spec, embedOpt){\n    let outputDiv = document.currentScript.previousElementSibling;\n    if (outputDiv.id !== \"altair-viz-3f14e628ce0944489be4782ad1ccad90\") {\n      outputDiv = document.getElementById(\"altair-viz-3f14e628ce0944489be4782ad1ccad90\");\n    }\n\n    const paths = {\n      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@5?noext\",\n      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext\",\n      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@6?noext\",\n    };\n\n    function maybeLoadScript(lib, version) {\n      var key = `${lib.replace(\"-\", \"\")}_version`;\n      return (VEGA_DEBUG[key] == version) ?\n        Promise.resolve(paths[lib]) :\n        new Promise(function(resolve, reject) {\n          var s = document.createElement('script');\n          document.getElementsByTagName(\"head\")[0].appendChild(s);\n          s.async = true;\n          s.onload = () => {\n            VEGA_DEBUG[key] = version;\n            return resolve(paths[lib]);\n          };\n          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n          s.src = paths[lib];\n        });\n    }\n\n    function showError(err) {\n      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n      throw err;\n    }\n\n    function displayChart(vegaEmbed) {\n      vegaEmbed(outputDiv, spec, embedOpt)\n        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n    }\n\n    if(typeof define === \"function\" && define.amd) {\n      requirejs.config({paths});\n      let deps = [\"vega-embed\"];\n      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));\n    } else {\n      maybeLoadScript(\"vega\", \"5\")\n        .then(() => maybeLoadScript(\"vega-lite\", \"5.20.1\"))\n        .then(() => maybeLoadScript(\"vega-embed\", \"6\"))\n        .catch(showError)\n        .then(() => displayChart(vegaEmbed));\n    }\n  })({\"config\": {\"view\": {\"continuousWidth\": 300, \"continuousHeight\": 300}}, \"layer\": [{\"mark\": {\"type\": \"circle\", \"size\": 65}, \"encoding\": {\"color\": {\"field\": \"clusters\", \"type\": \"nominal\"}, \"tooltip\": [{\"field\": \"Feature1\", \"type\": \"quantitative\"}, {\"field\": \"Feature2\", \"type\": \"quantitative\"}, {\"field\": \"index\", \"type\": \"nominal\"}], \"x\": {\"field\": \"Feature1\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"Feature2\", \"type\": \"quantitative\"}}, \"name\": \"view_1\"}, {\"mark\": {\"type\": \"text\", \"align\": \"left\", \"baseline\": \"middle\", \"dx\": 5}, \"encoding\": {\"text\": {\"field\": \"index\", \"type\": \"nominal\"}, \"x\": {\"field\": \"Feature1\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"Feature2\", \"type\": \"quantitative\"}}}], \"data\": {\"name\": \"data-4441c33e129c5c8c84c6e7efa56f3a9e\"}, \"height\": 500, \"params\": [{\"name\": \"param_1\", \"select\": {\"type\": \"interval\", \"encodings\": [\"x\", \"y\"]}, \"bind\": \"scales\", \"views\": [\"view_1\"]}], \"width\": 500, \"$schema\": \"https://vega.github.io/schema/vega-lite/v5.20.1.json\", \"datasets\": {\"data-4441c33e129c5c8c84c6e7efa56f3a9e\": [{\"Feature1\": 0.2693818929528234, \"Feature2\": 0.19186974333977425, \"clusters\": \"2\", \"index\": \"0\"}, {\"Feature1\": -0.3037710707765842, \"Feature2\": -1.1405590298531176, \"clusters\": \"0\", \"index\": \"1\"}, {\"Feature1\": -0.8769240345059943, \"Feature2\": -0.6075875205759604, \"clusters\": \"0\", \"index\": \"2\"}, {\"Feature1\": -1.1635005163707006, \"Feature2\": -0.874073275214539, \"clusters\": \"0\", \"index\": \"3\"}, {\"Feature1\": -0.017194588911880394, \"Feature2\": 0.45835549797835284, \"clusters\": \"2\", \"index\": \"4\"}, {\"Feature1\": 1.1291113385469398, \"Feature2\": 1.2578127618940875, \"clusters\": \"1\", \"index\": \"5\"}, {\"Feature1\": -1.1635005163707006, \"Feature2\": -0.07461601129880438, \"clusters\": \"0\", \"index\": \"6\"}, {\"Feature1\": -0.017194588911880394, \"Feature2\": -0.07461601129880438, \"clusters\": \"2\", \"index\": \"7\"}, {\"Feature1\": -1.7366534801001083, \"Feature2\": -1.4070447844916962, \"clusters\": \"0\", \"index\": \"8\"}, {\"Feature1\": -0.3037710707765842, \"Feature2\": -0.874073275214539, \"clusters\": \"0\", \"index\": \"9\"}, {\"Feature1\": 1.1291113385469398, \"Feature2\": 0.7248412526169314, \"clusters\": \"1\", \"index\": \"10\"}, {\"Feature1\": -0.5903475526412906, \"Feature2\": -0.07461601129880438, \"clusters\": \"0\", \"index\": \"11\"}, {\"Feature1\": -0.5903475526412906, \"Feature2\": -1.1405590298531176, \"clusters\": \"0\", \"index\": \"12\"}, {\"Feature1\": -2.0232299619648146, \"Feature2\": -1.1405590298531176, \"clusters\": \"0\", \"index\": \"13\"}, {\"Feature1\": 2.2754172660057574, \"Feature2\": 1.5242985165326661, \"clusters\": \"1\", \"index\": \"14\"}, {\"Feature1\": 1.9888407841410538, \"Feature2\": 2.5902415350869807, \"clusters\": \"1\", \"index\": \"15\"}, {\"Feature1\": 1.1291113385469398, \"Feature2\": 1.2578127618940875, \"clusters\": \"1\", \"index\": \"16\"}, {\"Feature1\": 0.2693818929528234, \"Feature2\": 0.19186974333977425, \"clusters\": \"2\", \"index\": \"17\"}, {\"Feature1\": 1.9888407841410538, \"Feature2\": 0.9913270072555089, \"clusters\": \"1\", \"index\": \"18\"}, {\"Feature1\": 0.2693818929528234, \"Feature2\": 0.9913270072555089, \"clusters\": \"1\", \"index\": \"19\"}, {\"Feature1\": 1.1291113385469398, \"Feature2\": -0.07461601129880438, \"clusters\": \"2\", \"index\": \"20\"}, {\"Feature1\": 0.2693818929528234, \"Feature2\": 0.7248412526169314, \"clusters\": \"1\", \"index\": \"21\"}, {\"Feature1\": -1.1635005163707006, \"Feature2\": 0.45835549797835284, \"clusters\": \"0\", \"index\": \"22\"}, {\"Feature1\": 0.2693818929528234, \"Feature2\": -0.341101765937383, \"clusters\": \"2\", \"index\": \"23\"}, {\"Feature1\": -0.5903475526412906, \"Feature2\": -0.07461601129880438, \"clusters\": \"0\", \"index\": \"24\"}, {\"Feature1\": -0.017194588911880394, \"Feature2\": -1.1405590298531176, \"clusters\": \"0\", \"index\": \"25\"}, {\"Feature1\": -0.017194588911880394, \"Feature2\": -0.07461601129880438, \"clusters\": \"2\", \"index\": \"26\"}, {\"Feature1\": 0.5559583748175297, \"Feature2\": 0.19186974333977425, \"clusters\": \"2\", \"index\": \"27\"}, {\"Feature1\": 0.5559583748175297, \"Feature2\": -0.07461601129880438, \"clusters\": \"2\", \"index\": \"28\"}, {\"Feature1\": -0.8769240345059943, \"Feature2\": -0.6075875205759604, \"clusters\": \"0\", \"index\": \"29\"}, {\"Feature1\": -0.5903475526412906, \"Feature2\": -0.874073275214539, \"clusters\": \"0\", \"index\": \"30\"}, {\"Feature1\": 1.1291113385469398, \"Feature2\": -0.07461601129880438, \"clusters\": \"2\", \"index\": \"31\"}, {\"Feature1\": 0.5559583748175297, \"Feature2\": 1.7907842711712436, \"clusters\": \"1\", \"index\": \"32\"}, {\"Feature1\": 1.4156878204116436, \"Feature2\": 2.0572700258098235, \"clusters\": \"1\", \"index\": \"33\"}, {\"Feature1\": -0.3037710707765842, \"Feature2\": -0.874073275214539, \"clusters\": \"0\", \"index\": \"34\"}, {\"Feature1\": -0.017194588911880394, \"Feature2\": -0.6075875205759604, \"clusters\": \"2\", \"index\": \"35\"}, {\"Feature1\": 1.4156878204116436, \"Feature2\": 0.19186974333977425, \"clusters\": \"2\", \"index\": \"36\"}, {\"Feature1\": -0.3037710707765842, \"Feature2\": 0.45835549797835284, \"clusters\": \"2\", \"index\": \"37\"}, {\"Feature1\": -1.7366534801001083, \"Feature2\": -1.1405590298531176, \"clusters\": \"0\", \"index\": \"38\"}, {\"Feature1\": 0.2693818929528234, \"Feature2\": -0.07461601129880438, \"clusters\": \"2\", \"index\": \"39\"}, {\"Feature1\": -0.017194588911880394, \"Feature2\": 0.19186974333977425, \"clusters\": \"2\", \"index\": \"40\"}, {\"Feature1\": -1.4500769982354045, \"Feature2\": -3.0059593123231667, \"clusters\": \"0\", \"index\": \"41\"}, {\"Feature1\": -1.7366534801001083, \"Feature2\": -0.6075875205759604, \"clusters\": \"0\", \"index\": \"42\"}, {\"Feature1\": -0.017194588911880394, \"Feature2\": 0.19186974333977425, \"clusters\": \"2\", \"index\": \"43\"}, {\"Feature1\": 0.2693818929528234, \"Feature2\": 0.9913270072555089, \"clusters\": \"1\", \"index\": \"44\"}, {\"Feature1\": -0.5903475526412906, \"Feature2\": -1.1405590298531176, \"clusters\": \"0\", \"index\": \"45\"}, {\"Feature1\": 0.2693818929528234, \"Feature2\": 0.9913270072555089, \"clusters\": \"1\", \"index\": \"46\"}, {\"Feature1\": -1.1635005163707006, \"Feature2\": -0.6075875205759604, \"clusters\": \"0\", \"index\": \"47\"}, {\"Feature1\": 0.8425348566822336, \"Feature2\": 0.7248412526169314, \"clusters\": \"1\", \"index\": \"48\"}, {\"Feature1\": -0.017194588911880394, \"Feature2\": -0.341101765937383, \"clusters\": \"2\", \"index\": \"49\"}]}}, {\"mode\": \"vega-lite\"});\n</script>\n```\n:::\n:::\n\n\n# Visualizar dendrogram\n\n## Creaci√≥n del linked\n\n::: {#391a3c65 .cell execution_count=7}\n``` {.python .cell-code}\n#X_scaled\n#‚Äòward‚Äô, ‚Äòcomplete‚Äô, ‚Äòaverage‚Äô, ‚Äòsingle‚Äô}\nlinked = linkage(X_scaled,method='complete')\n```\n:::\n\n\n## Dendrogram\n\n::: {#7b1bbf01 .cell execution_count=8}\n``` {.python .cell-code}\nplt.figure(figsize=(10, 5))\ndendrogram(linked,\n           orientation='top',\n           distance_sort='descending',\n           show_leaf_counts=False)\nplt.title(\"Dendrogram\")\nplt.xlabel(\"Sample index\")\nplt.ylabel(\"Distance\")\n# plt.grid(True)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](hac_files/figure-html/cell-9-output-1.png){}\n:::\n:::\n\n\n",
    "supporting": [
      "hac_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}